<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="PhuseSubTeamAnalysisResults@example.org" />

<meta name="date" content="2015-01-05" />

<title>Data qubes from Workbook</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Data qubes from Workbook</h1>
<h4 class="author"><em><a href="mailto:PhuseSubTeamAnalysisResults@example.org">PhuseSubTeamAnalysisResults@example.org</a></em></h4>
<h4 class="date"><em>2015-01-05</em></h4>
</div>


<div id="setup" class="section level1">
<h1>Setup</h1>
<p>First load the package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rrdfqbcrnd0)</code></pre>
</div>
<div id="generating-rdf-data-cube-from-specification-in-a-spreadsheet-and-export-as-turtle-file" class="section level1">
<h1>Generating RDF data cube from specification in a spreadsheet and export as turtle file</h1>
<p>The generation of RDF data cube can be specified in a spreadsheet. The outputs below shows the meta data for generation of the DM RDF data cube.</p>
<pre class="sourceCode r"><code class="sourceCode r">RDFCubeWorkbook&lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/sample-cfg&quot;</span>, <span class="st">&quot;RDFCubeWorkbook.xlsx&quot;</span>, <span class="dt">package=</span><span class="st">&quot;rrdfqbcrnd0&quot;</span>)
cubeMetadata &lt;-<span class="st"> </span><span class="kw">read.xlsx</span>(RDFCubeWorkbook,
                          <span class="dt">sheetName=</span><span class="kw">paste0</span>(<span class="st">&quot;DM-Components&quot;</span>),
                          <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)
knitr::<span class="kw">kable</span>(
  cubeMetadata[ cubeMetadata$compType %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dimension&quot;</span>, <span class="st">&quot;attribute&quot;</span>, <span class="st">&quot;measure&quot;</span>),
               <span class="kw">c</span>(<span class="st">&quot;codeType&quot;</span>, <span class="st">&quot;compName&quot;</span>,<span class="st">&quot;nciDomainValue&quot;</span>, <span class="st">&quot;compLabel&quot;</span>)]
  )</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">codeType</th>
<th align="left">compName</th>
<th align="left">nciDomainValue</th>
<th align="left">compLabel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">DATA</td>
<td align="left">trt01a</td>
<td align="left">NA</td>
<td align="left">Treatment Arm</td>
</tr>
<tr class="even">
<td align="left">SDTM</td>
<td align="left">sex</td>
<td align="left">C66731</td>
<td align="left">Sex (Gender)</td>
</tr>
<tr class="odd">
<td align="left">DATA</td>
<td align="left">saffl</td>
<td align="left">NA</td>
<td align="left">Safety Population Flag</td>
</tr>
<tr class="even">
<td align="left">DATA</td>
<td align="left">procedure</td>
<td align="left">NA</td>
<td align="left">Statistical Procedure</td>
</tr>
<tr class="odd">
<td align="left">DATA</td>
<td align="left">factor</td>
<td align="left">NA</td>
<td align="left">Type of procedure (quantity, proportion…)</td>
</tr>
<tr class="even">
<td align="left">SDTM</td>
<td align="left">race</td>
<td align="left">C74457</td>
<td align="left">Race</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">measure</td>
<td align="left">NA</td>
<td align="left">Value of the statistical measure</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">unit</td>
<td align="left">NA</td>
<td align="left">Unit of measure</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">denominator</td>
<td align="left">NA</td>
<td align="left">Denominator for a proportion (oskr) subset on which a statistic is based</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">knitr::<span class="kw">kable</span>(cubeMetadata[ cubeMetadata$compType==<span class="st">&quot;metadata&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;compName&quot;</span>,<span class="st">&quot;compLabel&quot;</span>)])</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">compName</th>
<th align="left">compLabel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">10</td>
<td align="left">obsURL</td>
<td align="left"><a href="https://phuse-scripts.googlecode.com/svn/trunk/scriptathon2014/data/adsl.xpt">https://phuse-scripts.googlecode.com/svn/trunk/scriptathon2014/data/adsl.xpt</a></td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="left">obsFileName</td>
<td align="left">dm.AR.csv</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="left">dataCubeFileName</td>
<td align="left">DC-DM-R-V</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="left">cubeVersion</td>
<td align="left">0.5.2</td>
</tr>
<tr class="odd">
<td align="left">14</td>
<td align="left">createdBy</td>
<td align="left">Tim Williams</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="left">description</td>
<td align="left">Cube with 6 Dimensions (factor, procedure, race, saffl, sex, trt01a), 2 Attributes (denominator, unit) and 1 measure (measure)</td>
</tr>
<tr class="odd">
<td align="left">16</td>
<td align="left">providedBy</td>
<td align="left">PhUSE Results Metadata Working Group</td>
</tr>
<tr class="even">
<td align="left">17</td>
<td align="left">comment</td>
<td align="left">Example Demographics data supplied by Ian Fleming via R.. All dimensions have a Codelist and Range specified. Attributes applied from source data. Attributes as VALUES instead of URIs. Changes in current version: codelists for factor, procedure, saffl, trt01a</td>
</tr>
<tr class="odd">
<td align="left">18</td>
<td align="left">title</td>
<td align="left">Demographics Analysis Results</td>
</tr>
<tr class="even">
<td align="left">19</td>
<td align="left">label</td>
<td align="left">Demographics results data set.</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="left">wasDerivedFrom</td>
<td align="left">demog.AR.csv</td>
</tr>
<tr class="even">
<td align="left">21</td>
<td align="left">domainName</td>
<td align="left">DM</td>
</tr>
<tr class="odd">
<td align="left">22</td>
<td align="left">obsFileNameDirectory</td>
<td align="left">!example</td>
</tr>
<tr class="even">
<td align="left">23</td>
<td align="left">dataCubeOutDirectory</td>
<td align="left">!temporary</td>
</tr>
</tbody>
</table>
<p>The next statements demonstrates how to create two RDF data cubes according to the specfications in the excel spreadsheet. Note the contents of the RDF data cube is read from the csv file given by obsFileName in directory given by obsFileNameDirectory. The value ```!example´´´ specifies that the file should be read from sample data in the package. The dataCubeOutDirectory give the directory name for the generated RDF data cube.</p>
<pre class="sourceCode r"><code class="sourceCode r">dm.cube.fn&lt;-<span class="st"> </span><span class="kw">BuildCubeFromWorkbook</span>(RDFCubeWorkbook, <span class="st">&quot;DM&quot;</span> )</code></pre>
<pre><code>## Start loading rdf.cdisc.org contents from /home/ma/R/x86_64-redhat-linux-gnu-library/3.1/rrdfqbcrnd0/extdata/CDISC-standards-rdf/cdisc-rdf.zip
## Done loading rdf.cdisc.org contents, number of triples: 164651</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;DM cube stored as &quot;</span>, dm.cube.fn, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre>
<pre><code>## DM cube stored as  /tmp/RtmpG1PhVH/DC-DM-R-V-0-5-2.TTL</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">ae.cube.fn&lt;-<span class="st"> </span><span class="kw">BuildCubeFromWorkbook</span>(RDFCubeWorkbook, <span class="st">&quot;AE&quot;</span> )
<span class="kw">cat</span>(<span class="st">&quot;AE cube stored as &quot;</span>, ae.cube.fn, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre>
<pre><code>## AE cube stored as  /tmp/RtmpG1PhVH/DC-AE-R-V-0-5-2.TTL</code></pre>
<div id="notes" class="section level2">
<h2>Notes</h2>
<p>In the read.xlsx, if all cells in a column is missing, then the input fails.</p>
<p>Future version may replace the use of the DomainName, eg. DM and AE in the examples above, with another way of deriving identification of the table</p>
<p>The attribute denominator may be changed to a dimension to handle more complex situations. For example if there are percentages for TRT01A and SEX using respectively TRT01A and SEX as denominator. This will be represented by two observations with by definition the same dimensions but different value for the attribute denominator. However, this will violate the intergrity constraints for a RDF Data Cube (TODO: Add IC name).</p>
<hr />
</div>
</div>
<div id="input-the-generated-turtle-file" class="section level1">
<h1>Input the generated turtle file</h1>
<p>Now look at the generated cubes by loading the turle files. Note: by specifying prefix the output contains is shown using the prefixes. Note for future: This may be a disadvantage if the value of the prefix, say ds, changes.</p>
<p>The rest of the code only depends on the value of dataCubeFile.</p>
<pre><code>## [1] &quot;Number of triples: 1039&quot;</code></pre>
<p>First set values for accessing the cube.</p>
<p>The next statement shows the first 10 triples in the cube.</p>
<table>
<thead>
<tr class="header">
<th align="left">s</th>
<th align="left">p</th>
<th align="left">o</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dccs:saffl</td>
<td align="left">qb:dimension</td>
<td align="left">prop:saffl</td>
</tr>
<tr class="even">
<td align="left">dccs:saffl</td>
<td align="left">rdfs:label</td>
<td align="left">Safety Population Flag</td>
</tr>
<tr class="odd">
<td align="left">dccs:saffl</td>
<td align="left">rdf:type</td>
<td align="left">qb:ComponentSpecification</td>
</tr>
<tr class="even">
<td align="left">ds:obs2</td>
<td align="left">prop:saffl</td>
<td align="left">code:saffl-Y</td>
</tr>
<tr class="odd">
<td align="left">ds:obs2</td>
<td align="left">prop:unit</td>
<td align="left"><em>NULL</em></td>
</tr>
<tr class="even">
<td align="left">ds:obs2</td>
<td align="left">rdfs:label</td>
<td align="left">2</td>
</tr>
</tbody>
</table>
<p>The next statement shows the first 10 triples in the cube, where the subject is a qb:Observation.</p>
<table>
<thead>
<tr class="header">
<th align="left">s</th>
<th align="left">p</th>
<th align="left">o</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ds:obs35</td>
<td align="left">rdfs:label</td>
<td align="left">35</td>
</tr>
<tr class="even">
<td align="left">ds:obs35</td>
<td align="left">prop:race</td>
<td align="left">code:race-AMERICAN_INDIAN_OR_ALASKA_NATIVE</td>
</tr>
<tr class="odd">
<td align="left">ds:obs35</td>
<td align="left">rdf:type</td>
<td align="left">qb:Observation</td>
</tr>
<tr class="even">
<td align="left">ds:obs35</td>
<td align="left">prop:denominator</td>
<td align="left">RACE</td>
</tr>
<tr class="odd">
<td align="left">ds:obs35</td>
<td align="left">prop:measure</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">ds:obs35</td>
<td align="left">prop:procedure</td>
<td align="left">code:procedure-percent</td>
</tr>
<tr class="odd">
<td align="left">ds:obs35</td>
<td align="left">prop:factor</td>
<td align="left">code:factor-proportion</td>
</tr>
<tr class="even">
<td align="left">ds:obs35</td>
<td align="left">prop:trt01a</td>
<td align="left">code:trt01a-Placebo</td>
</tr>
<tr class="odd">
<td align="left">ds:obs35</td>
<td align="left">prop:saffl</td>
<td align="left">code:saffl-Y</td>
</tr>
<tr class="even">
<td align="left">ds:obs35</td>
<td align="left">qb:dataSet</td>
<td align="left">ds:dataset-DM</td>
</tr>
</tbody>
</table>
<p>The codelists are shown in the next output.</p>
<pre><code>##           vn                                            clc
## 1     factor                                     factor-AGE
## 2     factor                              factor-proportion
## 3     factor                                factor-quantity
## 4  procedure                                procedure-count
## 5  procedure                                  procedure-max
## 6  procedure                                 procedure-mean
## 7  procedure                               procedure-median
## 8  procedure                                  procedure-min
## 9  procedure                              procedure-percent
## 10 procedure                                procedure-stdev
## 11      race          race-AMERICAN_INDIAN_OR_ALASKA_NATIVE
## 12      race                                     race-ASIAN
## 13      race                 race-BLACK_OR_AFRICAN_AMERICAN
## 14      race race-NATIVE_HAWAIIAN_OR_OTHER_PACIFIC_ISLANDER
## 15      race                                     race-WHITE
## 16      race                                     race-_ALL_
## 17     saffl                                        saffl-Y
## 18       sex                                          sex-F
## 19       sex                                          sex-M
## 20       sex                                          sex-U
## 21       sex                                         sex-UN
## 22       sex                                      sex-_ALL_
## 23    trt01a                                 trt01a-Placebo
## 24    trt01a                    trt01a-Xanomeline_High_Dose
## 25    trt01a                     trt01a-Xanomeline_Low_Dose
## 26    trt01a                                   trt01a-_ALL_
##                                    prefLabel
## 1                                        AGE
## 2                                 proportion
## 3                                   quantity
## 4                                      count
## 5                                        max
## 6                                       mean
## 7                                     median
## 8                                        min
## 9                                    percent
## 10                                     stdev
## 11          AMERICAN INDIAN OR ALASKA NATIVE
## 12                                     ASIAN
## 13                 BLACK OR AFRICAN AMERICAN
## 14 NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER
## 15                                     WHITE
## 16                                     _ALL_
## 17                                         Y
## 18                                         F
## 19                                         M
## 20                                         U
## 21                                        UN
## 22                                     _ALL_
## 23                                   Placebo
## 24                      Xanomeline High Dose
## 25                       Xanomeline Low Dose
## 26                                     _ALL_</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">vn</th>
<th align="left">clc</th>
<th align="left">prefLabel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">factor</td>
<td align="left">factor-AGE</td>
<td align="left">AGE</td>
</tr>
<tr class="even">
<td align="left">factor</td>
<td align="left">factor-proportion</td>
<td align="left">proportion</td>
</tr>
<tr class="odd">
<td align="left">factor</td>
<td align="left">factor-quantity</td>
<td align="left">quantity</td>
</tr>
<tr class="even">
<td align="left">procedure</td>
<td align="left">procedure-count</td>
<td align="left">count</td>
</tr>
<tr class="odd">
<td align="left">procedure</td>
<td align="left">procedure-max</td>
<td align="left">max</td>
</tr>
<tr class="even">
<td align="left">procedure</td>
<td align="left">procedure-mean</td>
<td align="left">mean</td>
</tr>
<tr class="odd">
<td align="left">procedure</td>
<td align="left">procedure-median</td>
<td align="left">median</td>
</tr>
<tr class="even">
<td align="left">procedure</td>
<td align="left">procedure-min</td>
<td align="left">min</td>
</tr>
<tr class="odd">
<td align="left">procedure</td>
<td align="left">procedure-percent</td>
<td align="left">percent</td>
</tr>
<tr class="even">
<td align="left">procedure</td>
<td align="left">procedure-stdev</td>
<td align="left">stdev</td>
</tr>
<tr class="odd">
<td align="left">race</td>
<td align="left">race-AMERICAN_INDIAN_OR_ALASKA_NATIVE</td>
<td align="left">AMERICAN INDIAN OR ALASKA NATIVE</td>
</tr>
<tr class="even">
<td align="left">race</td>
<td align="left">race-ASIAN</td>
<td align="left">ASIAN</td>
</tr>
<tr class="odd">
<td align="left">race</td>
<td align="left">race-BLACK_OR_AFRICAN_AMERICAN</td>
<td align="left">BLACK OR AFRICAN AMERICAN</td>
</tr>
<tr class="even">
<td align="left">race</td>
<td align="left">race-NATIVE_HAWAIIAN_OR_OTHER_PACIFIC_ISLANDER</td>
<td align="left">NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER</td>
</tr>
<tr class="odd">
<td align="left">race</td>
<td align="left">race-WHITE</td>
<td align="left">WHITE</td>
</tr>
<tr class="even">
<td align="left">race</td>
<td align="left">race-<em>ALL</em></td>
<td align="left"><em>ALL</em></td>
</tr>
<tr class="odd">
<td align="left">saffl</td>
<td align="left">saffl-Y</td>
<td align="left">Y</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="left">sex-F</td>
<td align="left">F</td>
</tr>
<tr class="odd">
<td align="left">sex</td>
<td align="left">sex-M</td>
<td align="left">M</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="left">sex-U</td>
<td align="left">U</td>
</tr>
<tr class="odd">
<td align="left">sex</td>
<td align="left">sex-UN</td>
<td align="left">UN</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="left">sex-<em>ALL</em></td>
<td align="left"><em>ALL</em></td>
</tr>
<tr class="odd">
<td align="left">trt01a</td>
<td align="left">trt01a-Placebo</td>
<td align="left">Placebo</td>
</tr>
<tr class="even">
<td align="left">trt01a</td>
<td align="left">trt01a-Xanomeline_High_Dose</td>
<td align="left">Xanomeline High Dose</td>
</tr>
<tr class="odd">
<td align="left">trt01a</td>
<td align="left">trt01a-Xanomeline_Low_Dose</td>
<td align="left">Xanomeline Low Dose</td>
</tr>
<tr class="even">
<td align="left">trt01a</td>
<td align="left">trt01a-<em>ALL</em></td>
<td align="left"><em>ALL</em></td>
</tr>
</tbody>
</table>
<div id="notes-1" class="section level2">
<h2>Notes</h2>
<p>instead of using gsub the codelist values should be obtained in a more straightforward way</p>
<p>this involves a new version of the ph.recode function</p>
<p>the rrdf package could be extended to expand the URI using the Jena expandPrefix method</p>
<hr />
<p>The dimensions are shown in the next output.</p>
</div>
<div id="p" class="section level2">
<h2>p</h2>
<p>prop:trt01a<br />prop:race<br />prop:factor<br />prop:procedure prop:sex<br />prop:saffl</p>
<p>Then the attributes as shown in the next output.</p>
</div>
<div id="p-1" class="section level2">
<h2>p</h2>
<p>prop:unit<br />prop:denominator</p>
<p>And finally the SPARQL query for observations, showing only the first 10 observations.</p>
<pre><code>## prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;
## prefix skos: &lt;http://www.w3.org/2004/02/skos/core#&gt;
## prefix prov: &lt;http://www.w3.org/ns/prov#&gt;
## prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
## prefix dcat: &lt;http://www.w3.org/ns/dcat#&gt;
## prefix owl: &lt;http://www.w3.org/2002/07/owl#&gt;
## prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;
## prefix qb: &lt;http://purl.org/linked-data/cube#&gt;
## prefix pav: &lt;http://purl.org/pav&gt;
## prefix dct: &lt;http://purl.org/dc/terms/&gt;
## prefix mms: &lt;http://rdf.cdisc.org/mms#&gt;
## prefix cts: &lt;http://rdf.cdisc.org/ct/schema#&gt;
## prefix rrdfqbcrnd0: &lt;http://www.example.org/rrdfqbcrnd0/&gt;
## prefix code: &lt;http://www.example.org/dc/code/&gt;
## prefix prop: &lt;http://www.example.org/dc/dm/prop/&gt;
## prefix dccs: &lt;http://www.example.org/dc/dm/dccs/&gt;
## prefix ds: &lt;http://www.example.org/dc/dm/ds/&gt;
##  select * where { ?s a qb:Observation  ; 
##         qb:dataSet ds:dataset-DM  ; 
##  prop:trt01a ?trt01a;
## prop:race ?race;
## prop:factor ?factor;
## prop:procedure ?procedure;
## prop:sex ?sex;
## prop:saffl ?saffl; prop:unit ?unit;
## prop:denominator ?denominator; prop:measure      ?measure ;      
##  optional{ ?trt01a skos:prefLabel ?trt01avalue . }
## optional{ ?race skos:prefLabel ?racevalue . }
## optional{ ?factor skos:prefLabel ?factorvalue . }
## optional{ ?procedure skos:prefLabel ?procedurevalue . }
## optional{ ?sex skos:prefLabel ?sexvalue . }
## optional{ ?saffl skos:prefLabel ?safflvalue . } 
##  }</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">trt01avalue</th>
<th align="left">racevalue</th>
<th align="left">factorvalue</th>
<th align="left">procedurevalue</th>
<th align="left">sexvalue</th>
<th align="left">safflvalue</th>
<th align="left">unit</th>
<th align="left">denominator</th>
<th align="left">measure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Placebo</td>
<td align="left">AMERICAN INDIAN OR ALASKA NATIVE</td>
<td align="left">proportion</td>
<td align="left">percent</td>
<td align="left"><em>ALL</em></td>
<td align="left">Y</td>
<td align="left"><em>NULL</em></td>
<td align="left">RACE</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Xanomeline High Dose</td>
<td align="left">AMERICAN INDIAN OR ALASKA NATIVE</td>
<td align="left">proportion</td>
<td align="left">percent</td>
<td align="left"><em>ALL</em></td>
<td align="left">Y</td>
<td align="left"><em>NULL</em></td>
<td align="left">RACE</td>
<td align="left">1.19047619</td>
</tr>
<tr class="odd">
<td align="left">Xanomeline High Dose</td>
<td align="left">BLACK OR AFRICAN AMERICAN</td>
<td align="left">proportion</td>
<td align="left">percent</td>
<td align="left"><em>ALL</em></td>
<td align="left">Y</td>
<td align="left"><em>NULL</em></td>
<td align="left">RACE</td>
<td align="left">10.71428571</td>
</tr>
<tr class="even">
<td align="left">Placebo</td>
<td align="left"><em>ALL</em></td>
<td align="left">quantity</td>
<td align="left">count</td>
<td align="left">F</td>
<td align="left">Y</td>
<td align="left"><em>NULL</em></td>
<td align="left"><em>ALL</em></td>
<td align="left">53</td>
</tr>
<tr class="odd">
<td align="left">Placebo</td>
<td align="left"><em>ALL</em></td>
<td align="left">quantity</td>
<td align="left">count</td>
<td align="left"><em>ALL</em></td>
<td align="left">Y</td>
<td align="left"><em>NULL</em></td>
<td align="left"><em>ALL</em></td>
<td align="left">86</td>
</tr>
<tr class="even">
<td align="left">Xanomeline Low Dose</td>
<td align="left"><em>ALL</em></td>
<td align="left">AGE</td>
<td align="left">stdev</td>
<td align="left"><em>ALL</em></td>
<td align="left">Y</td>
<td align="left">YEARS</td>
<td align="left"><em>NULL</em></td>
<td align="left">8.2860506</td>
</tr>
<tr class="odd">
<td align="left">Xanomeline High Dose</td>
<td align="left"><em>ALL</em></td>
<td align="left">AGE</td>
<td align="left">mean</td>
<td align="left"><em>ALL</em></td>
<td align="left">Y</td>
<td align="left">YEARS</td>
<td align="left"><em>NULL</em></td>
<td align="left">74.38095238</td>
</tr>
<tr class="even">
<td align="left">Xanomeline Low Dose</td>
<td align="left"><em>ALL</em></td>
<td align="left">proportion</td>
<td align="left">percent</td>
<td align="left">M</td>
<td align="left">Y</td>
<td align="left"><em>NULL</em></td>
<td align="left">SEX</td>
<td align="left">40.47619048</td>
</tr>
<tr class="odd">
<td align="left">Placebo</td>
<td align="left"><em>ALL</em></td>
<td align="left">AGE</td>
<td align="left">mean</td>
<td align="left"><em>ALL</em></td>
<td align="left">Y</td>
<td align="left">YEARS</td>
<td align="left"><em>NULL</em></td>
<td align="left">75.20930233</td>
</tr>
<tr class="even">
<td align="left">Placebo</td>
<td align="left">WHITE</td>
<td align="left">quantity</td>
<td align="left">count</td>
<td align="left"><em>ALL</em></td>
<td align="left">Y</td>
<td align="left"><em>NULL</em></td>
<td align="left"><em>ALL</em></td>
<td align="left">78</td>
</tr>
</tbody>
</table>
<p>Here is how to re-produce the metadata for the workbook. First get the dimensions, measure and attribute</p>
<table>
<thead>
<tr class="header">
<th align="left">compType</th>
<th align="left">compName</th>
<th align="left">codeType</th>
<th align="left">nciDomainValue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dimension</td>
<td align="left">prop:trt01a</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">dimension</td>
<td align="left">prop:race</td>
<td align="left">NA</td>
<td align="left">C74457</td>
</tr>
<tr class="odd">
<td align="left">dimension</td>
<td align="left">prop:factor</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">dimension</td>
<td align="left">prop:procedure</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">dimension</td>
<td align="left">prop:sex</td>
<td align="left">NA</td>
<td align="left">C66731</td>
</tr>
<tr class="even">
<td align="left">dimension</td>
<td align="left">prop:saffl</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">attribute</td>
<td align="left">prop:unit</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">attribute</td>
<td align="left">prop:denominator</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">measure</td>
<td align="left">prop:measure</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p>Secondly, get the metadata for the workbook. To get the metadata element “cubeVersion” a workaround is needed. The cubeversion is not directly available but from dcat:distribution derived as the result of paste0(“DC-”, domainName,“-R-V-”,cubeVersion,“.TTL”).</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">compType</th>
<th align="left">compName</th>
<th align="left">compLabel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">metadata</td>
<td align="left">title</td>
<td align="left">Demographics Analysis Results</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">metadata</td>
<td align="left">distribution</td>
<td align="left">DC-DM-R-V-0-5-2.TTL</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">metadata</td>
<td align="left">comment</td>
<td align="left">Example Demographics data supplied by Ian Fleming via R.. All dimensions have a Codelist and Range specified. Attributes applied from source data. Attributes as VALUES instead of URIs. Changes in current version: codelists for factor, procedure, saffl, trt01a</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">metadata</td>
<td align="left">label</td>
<td align="left">Demographics results data set.</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">metadata</td>
<td align="left">description</td>
<td align="left">Cube with 6 Dimensions (factor, procedure, race, saffl, sex, trt01a), 2 Attributes (denominator, unit) and 1 measure (measure)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">metadata</td>
<td align="left">obsFileName</td>
<td align="left">dm.AR.csv</td>
</tr>
<tr class="odd">
<td align="left">compLabel</td>
<td align="left">metadata</td>
<td align="left">cubeVersion</td>
<td align="left">0.5.2</td>
</tr>
</tbody>
</table>
<p>For comparison, see the meta data from the excel workbook in the beginning of the document.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
